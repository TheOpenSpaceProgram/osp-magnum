##
# Open Space Program
# Copyright Â© 2019-2020 Open Space Program Project
#
# MIT License
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in
# all copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.
##

SET(INSTALL_GTEST    OFF CACHE BOOL "" FORCE)
SET(BUILD_TESTING    OFF CACHE BOOL "" FORCE)
SET(BUILD_DEPRECATED OFF CACHE BOOL "" FORCE)
SET(BUILD_GMOCK      OFF CACHE BOOL "" FORCE)
SET(BUILD_STATIC     ON  CACHE BOOL "" FORCE)

if(NOT OSP_USE_SYSTEM_SDL)
  # This is the most minimal set of features which still make Sdl2Application
  # work. If you need something from these, remove the setting. The SDL_AUDIO
  # option (and SDL_DLOPEN) should not be needed either as Magnum doesn't use it,
  # but if it's disabled it causes linker errors. Needs further investigation.
  SET(SDL_ATOMIC     OFF CACHE BOOL "" FORCE)
  SET(SDL_CPUINFO    OFF CACHE BOOL "" FORCE)
  SET(SDL_FILE       ON  CACHE BOOL "" FORCE) # Needed for Mac OSX
  SET(SDL_FILESYSTEM OFF CACHE BOOL "" FORCE)
  SET(SDL_HAPTIC     OFF CACHE BOOL "" FORCE)
  SET(SDL_LOCALE     OFF CACHE BOOL "" FORCE)
  SET(SDL_POWER      OFF CACHE BOOL "" FORCE)
  SET(SDL_RENDER     OFF CACHE BOOL "" FORCE)
  SET(SDL_SENSOR     OFF CACHE BOOL "" FORCE)
  SET(SDL_THREADS    OFF CACHE BOOL "" FORCE)
  SET(SDL_TIMERS     OFF CACHE BOOL "" FORCE)

  SET(SDL_AUDIO         ON  CACHE BOOL "" FORCE)
  SET(PULSEAUDIO        ON  CACHE BOOL "" FORCE)
  SET(PULSEAUDIO_SHARED OFF CACHE BOOL "" FORCE)
  SET(ALSA              OFF CACHE BOOL "" FORCE)
  SET(ALSA_SHARED       OFF CACHE BOOL "" FORCE)
  SET(JACK              OFF CACHE BOOL "" FORCE)
  SET(JACK_SHARED       OFF CACHE BOOL "" FORCE)
  SET(DISKAUDIO         OFF CACHE BOOL "" FORCE)
  SET(DISKAUDIO_SHARED  OFF CACHE BOOL "" FORCE)
  SET(SNDIO             OFF CACHE BOOL "" FORCE)
  SET(SNDIO_SHARED      OFF CACHE BOOL "" FORCE)
  SET(DUMMYAUDIO        OFF CACHE BOOL "" FORCE)
  SET(DUMMYAUDIO_SHARED OFF CACHE BOOL "" FORCE)
  SET(ESD               OFF CACHE BOOL "" FORCE)
  SET(ESD_SHARED        OFF CACHE BOOL "" FORCE)
  SET(ARTS              OFF CACHE BOOL "" FORCE)
  SET(ARTS_SHARED       OFF CACHE BOOL "" FORCE)
  SET(NAS               OFF CACHE BOOL "" FORCE)
  SET(NAS_SHARED        OFF CACHE BOOL "" FORCE)
  SET(OSS               OFF CACHE BOOL "" FORCE)
  SET(OSS_SHARED        OFF CACHE BOOL "" FORCE)

  SET(SDL_JOYSTICK     ON  CACHE BOOL "" FORCE)
  SET(JOYSTICK_VIRTUAL ON  CACHE BOOL "" FORCE)

  SET(SDL_LOADSO             ON  CACHE BOOL "" FORCE)
  SET(SDL_VIDEO              ON  CACHE BOOL "" FORCE)
  SET(VIDEO_VULKAN           OFF CACHE BOOL "" FORCE)
  SET(VIDEO_DUMMY            OFF CACHE BOOL "" FORCE)
  SET(VIDEO_OPENGL           ON  CACHE BOOL "" FORCE)
  SET(VIDEO_OPENGLES         OFF CACHE BOOL "" FORCE)
  SET(VIDEO_WAYLAND          OFF CACHE BOOL "" FORCE)
  SET(VIDEO_WAYLAND_QT_TOUCH OFF CACHE BOOL "" FORCE)
  SET(VIDEO_KMSDRM           OFF CACHE BOOL "" FORCE)
  SET(KMSDRM_SHARED          OFF CACHE BOOL "" FORCE)
  SET(VIDEO_RPI              OFF CACHE BOOL "" FORCE)
  SET(VIDEO_VIVANTE          OFF CACHE BOOL "" FORCE)

  SET(LIBSAMPLERATE          ON CACHE BOOL "" FORCE)
  SET(LIBSAMPLERATE_SHARED   ON CACHE BOOL "" FORCE)

  SET(SDL_EVENTS     ON  CACHE BOOL "" FORCE)

  # This assumes you want to have SDL as a static library. If not, set SDL_STATIC
  # to OFF instead.
  SET(SDL_DLOPEN ON  CACHE BOOL "" FORCE)
  SET(SDL_SHARED ON  CACHE BOOL "" FORCE)
  SET(SDL_STATIC OFF CACHE BOOL "" FORCE)

  ADD_SUBDIRECTORY(SDL2 EXCLUDE_FROM_ALL)
endif() # NOT OSP_USE_SYSTEM_SDL

ADD_SUBDIRECTORY(corrade EXCLUDE_FROM_ALL)

SET(BUILD_PLUGINS_STATIC  ON  CACHE BOOL "" FORCE)
SET(WITH_SDL2APPLICATION  ON  CACHE BOOL "" FORCE)
SET(WITH_ANYIMAGEIMPORTER ON  CACHE BOOL "" FORCE)
SET(WITH_TESTSUITE        OFF CACHE BOOL "" FORCE)
ADD_SUBDIRECTORY(magnum EXCLUDE_FROM_ALL)

SET(WITH_TINYGLTFIMPORTER ON CACHE BOOL "" FORCE)
SET(WITH_STBIMAGEIMPORTER ON CACHE BOOL "" FORCE)
ADD_SUBDIRECTORY(magnum-plugins EXCLUDE_FROM_ALL)

SET(NEWTON_BUILD_SANDBOX_DEMOS       OFF CACHE BOOL "" FORCE)
SET(NEWTON_BUILD_SHARED_LIBS         ON  CACHE BOOL "" FORCE)
SET(NEWTON_USE_PLUGIN_DLL            OFF CACHE BOOL "" FORCE)
SET(NEWTON_WITH_AVX_PLUGIN           OFF CACHE BOOL "" FORCE)
SET(NEWTON_WITH_REFERENCE_GPU_PLUGIN OFF CACHE BOOL "" FORCE)

ADD_SUBDIRECTORY(newton-dynamics EXCLUDE_FROM_ALL)

ADD_SUBDIRECTORY(entt EXCLUDE_FROM_ALL)
ADD_SUBDIRECTORY(toml11 EXCLUDE_FROM_ALL)
ADD_SUBDIRECTORY(spdlog EXCLUDE_FROM_ALL)
ADD_SUBDIRECTORY(longeronpp EXCLUDE_FROM_ALL)

# For Windows: Prevent overriding the parent project's compiler/linker settings
SET(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
ADD_SUBDIRECTORY(googletest EXCLUDE_FROM_ALL)
